# Docker Environment Configuration for Wazuh MCP Server
# This file is used inside the Docker container for default settings
# Override these via docker run -e or docker-compose environment section

# =============================================================================
# DOCKER-SPECIFIC SETTINGS
# =============================================================================

# Environment type
ENVIRONMENT=docker
DEPLOYMENT_STAGE=production

# Container metadata
VERSION=v2.0.0
BUILD_ARCH=amd64

# Python optimization for containers
PYTHONUNBUFFERED=1
PYTHONDONTWRITEBYTECODE=1
PYTHONHASHSEED=random

# Logging configuration (optimized for containers)
LOG_LEVEL=INFO
STRUCTURED_LOGGING=true
DEBUG=false
LOG_TO_CONSOLE=true
LOG_TO_FILE=false

# =============================================================================
# MCP TRANSPORT CONFIGURATION  
# =============================================================================

# Transport mode (stdio for standard Claude Desktop, remote for Custom Connectors, http for legacy)
MCP_TRANSPORT=stdio

# Server settings (used for both remote and http modes)
MCP_HOST=0.0.0.0
MCP_PORT=3000

# Public URL configuration (for production deployment)
# Examples:
# MCP_PUBLIC_URL=https://wazuh.company.com
# MCP_PUBLIC_URL=https://192.168.1.100/wazuhsse
MCP_PUBLIC_URL=http://localhost:3000

# Base path for reverse proxy deployment (optional)
# Examples:
# MCP_BASE_PATH=/wazuhsse
# MCP_BASE_PATH=/api/v1/mcp
MCP_BASE_PATH=

# CORS origins (comma-separated)
CORS_ORIGINS=https://claude.ai,https://*.anthropic.com

# =============================================================================
# WAZUH SERVER CONFIGURATION (SET VIA ENVIRONMENT VARIABLES)
# =============================================================================

# These are typically set via docker run -e or docker-compose environment section
# WAZUH_HOST=your-wazuh-server.com
# WAZUH_PORT=55000
# WAZUH_USER=your-api-user
# WAZUH_PASS=your-password

# =============================================================================
# WAZUH INDEXER CONFIGURATION (FOR DISTRIBUTED DEPLOYMENTS)
# =============================================================================

# Indexer connection (set via environment variables if different from server)
# WAZUH_INDEXER_HOST=your-indexer-server.com
# WAZUH_INDEXER_PORT=9200
# WAZUH_INDEXER_USER=indexer-username
# WAZUH_INDEXER_PASS=indexer-password

# Enable Indexer features (required for Wazuh 4.8.0+ vulnerability detection)
USE_INDEXER_FOR_ALERTS=true
USE_INDEXER_FOR_VULNERABILITIES=true

# Wazuh 4.8+ specific features
ENABLE_CENTRALIZED_VULNERABILITY_DETECTION=true
ENABLE_AUTO_SSL_NEGOTIATION=true

# Wazuh 4.12+ enhanced features
ENABLE_CTI_INTEGRATION=true
ENABLE_PACKAGE_CONDITION_FIELDS=true
USE_UTC_TIMESTAMPS=true
ENABLE_EBPF_FIM_MONITORING=false

# =============================================================================
# PERFORMANCE SETTINGS (CONTAINER-OPTIMIZED)
# =============================================================================

# Resource limits for containers
MAX_ALERTS_PER_QUERY=1000
MAX_AGENTS_PER_SCAN=10
CACHE_TTL_SECONDS=300
REQUEST_TIMEOUT_SECONDS=30
MAX_CONNECTIONS=10

# =============================================================================
# SECURITY SETTINGS (CONTAINER-SAFE DEFAULTS)
# =============================================================================

# SSL verification (recommended: true)
VERIFY_SSL=true

# Rate limiting
MAX_REQUESTS_PER_MINUTE=100
BURST_REQUEST_SIZE=20

# =============================================================================
# MONITORING (CONTAINER-FRIENDLY)
# =============================================================================

# Health checks and metrics
ENABLE_HEALTH_CHECKS=true
HEALTH_CHECK_INTERVAL=60
ENABLE_METRICS=true
METRICS_INTERVAL=30

# Memory management for containers
MAX_CACHE_MEMORY_MB=256
MAX_CONTEXT_COUNT=50
CACHE_CLEANUP_AGGRESSIVE=true

# =============================================================================
# OPTIONAL FEATURES
# =============================================================================

# AI-powered features
ENABLE_EXTERNAL_INTEL=true
ENABLE_ML_ANALYSIS=true
ENABLE_COMPLIANCE_CHECKING=true

# Production optimizations
ENABLE_HTTP2=true
KEEPALIVE_TIMEOUT=30

# ================================================================
# FASTMCP-SPECIFIC SETTINGS
# ================================================================

# FastMCP server configuration
FASTMCP_LOG_LEVEL=INFO
FASTMCP_ENABLE_VALIDATION=true
FASTMCP_MAX_CONCURRENT_REQUESTS=10

# ================================================================
# REMOTE MCP SERVER AUTHENTICATION
# ================================================================

# Bearer authentication (Phase 1 - simple token validation)
ENABLE_BEARER_AUTH=true
# Phase 1: Development token (starts with 'wazuh_')
# Phase 2: Will implement proper OAuth 2.1
MCP_AUTH_TOKEN=wazuh_dev_token_2024

# OAuth 2.1 settings (Phase 2 - not yet implemented)
OAUTH_BASE_URL=https://localhost:3000
JWKS_URI=
JWT_ISSUER=
JWT_AUDIENCE=wazuh-mcp-server
JWT_ALGORITHM=RS256
REQUIRED_SCOPES=wazuh:read,wazuh:alerts,wazuh:agents

# Elicitation features
ENABLE_USER_ELICITATION=true
ELICITATION_TIMEOUT=300