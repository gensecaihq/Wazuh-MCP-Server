# Wazuh MCP Server - Production Configuration Template
# Copy this file to .env and customize for your environment
# All configurations are optimized for production deployment

# ================================================================
# REQUIRED: WAZUH SERVER CONFIGURATION
# ================================================================
# Primary Wazuh Manager Server
WAZUH_HOST=your-wazuh-manager.company.com
WAZUH_PORT=55000
WAZUH_USER=mcp-api-user
WAZUH_PASS=your-secure-api-password
WAZUH_API_VERSION=v4

# ================================================================
# OPTIONAL: WAZUH INDEXER CONFIGURATION (Distributed Setup)
# ================================================================
# Leave empty if using same server as Wazuh Manager
WAZUH_INDEXER_HOST=your-wazuh-indexer.company.com
WAZUH_INDEXER_PORT=9200
WAZUH_INDEXER_USER=indexer-api-user
WAZUH_INDEXER_PASS=your-indexer-password

# Enable Indexer features for better performance
USE_INDEXER_FOR_ALERTS=true
USE_INDEXER_FOR_VULNERABILITIES=true
USE_INDEXER_FOR_COMPLIANCE=true

# ================================================================
# MCP TRANSPORT CONFIGURATION
# ================================================================
# Transport mode: 'stdio' for Claude Desktop, 'http' for remote access
MCP_TRANSPORT=stdio
MCP_HOST=0.0.0.0
MCP_PORT=3000

# CORS settings for HTTP mode (comma-separated origins)
MCP_CORS_ORIGINS=https://claude.ai,https://your-domain.com

# ================================================================
# SSL/TLS SECURITY CONFIGURATION
# ================================================================
# SSL certificate verification (ALWAYS true in production)
VERIFY_SSL=true
ALLOW_SELF_SIGNED=false
SSL_TIMEOUT=30

# Custom SSL certificates (optional)
CA_BUNDLE_PATH=/app/config/certs/ca-bundle.pem
CLIENT_CERT_PATH=/app/config/certs/client.crt
CLIENT_KEY_PATH=/app/config/certs/client.key

# Indexer SSL settings (if different from main server)
WAZUH_INDEXER_VERIFY_SSL=true
INDEXER_CA_BUNDLE_PATH=/app/config/certs/indexer-ca.pem

# ================================================================
# PERFORMANCE AND OPTIMIZATION
# ================================================================
# Query limits and timeouts
MAX_ALERTS_PER_QUERY=1000
MAX_VULNERABILITIES_PER_QUERY=500
MAX_AGENTS_PER_QUERY=200
REQUEST_TIMEOUT_SECONDS=30
LONG_RUNNING_TIMEOUT=120

# Connection pooling
MAX_CONNECTIONS=25
POOL_SIZE=10
POOL_MAX_SIZE=25
CONNECTION_RETRY_ATTEMPTS=3
CONNECTION_RETRY_DELAY=5

# Caching configuration
CACHE_TTL_SECONDS=300
ENABLE_RESPONSE_CACHING=true
CACHE_MAX_SIZE_MB=100

# ================================================================
# RATE LIMITING AND THROTTLING
# ================================================================
MAX_REQUESTS_PER_MINUTE=100
BURST_REQUEST_SIZE=20
RATE_LIMIT_WINDOW_SECONDS=60

# Per-tool rate limits (optional)
ALERTS_RATE_LIMIT=30
VULNERABILITIES_RATE_LIMIT=20
AGENTS_RATE_LIMIT=15

# ================================================================
# LOGGING AND MONITORING
# ================================================================
# Logging levels: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO
STRUCTURED_LOGGING=true
ENABLE_LOG_ROTATION=true
MAX_LOG_SIZE_MB=10
LOG_BACKUP_COUNT=5

# Log destinations
LOG_TO_FILE=true
LOG_TO_CONSOLE=true
LOG_DIR=/app/logs

# Performance monitoring
ENABLE_METRICS=true
ENABLE_HEALTH_CHECKS=true
HEALTH_CHECK_INTERVAL=30
PERFORMANCE_LOGGING=true

# ================================================================
# EXTERNAL THREAT INTELLIGENCE APIS (Optional)
# ================================================================
# VirusTotal API for malware analysis
VIRUSTOTAL_API_KEY=your-virustotal-api-key
VIRUSTOTAL_RATE_LIMIT=4

# Shodan API for network reconnaissance
SHODAN_API_KEY=your-shodan-api-key

# AbuseIPDB API for IP reputation
ABUSEIPDB_API_KEY=your-abuseipdb-api-key

# OTX AlienVault API for threat intelligence
OTX_API_KEY=your-otx-api-key

# ================================================================
# AI AND ANALYSIS FEATURES
# ================================================================
# Enable AI-powered analysis features
ENABLE_AI_ANALYSIS=true
ENABLE_ML_ANALYSIS=true
ENABLE_COMPLIANCE_CHECKING=true
ENABLE_THREAT_HUNTING=true

# Analysis thresholds
HIGH_SEVERITY_THRESHOLD=7
CRITICAL_SEVERITY_THRESHOLD=9
MAX_ANALYSIS_DEPTH=3

# ================================================================
# SECURITY HARDENING
# ================================================================
# Security features
ENABLE_INPUT_VALIDATION=true
ENABLE_OUTPUT_SANITIZATION=true
ENABLE_AUDIT_LOGGING=true
ENABLE_SESSION_TRACKING=true

# Authentication and authorization
ENABLE_JWT_VALIDATION=true
JWT_SECRET_KEY=your-jwt-secret-key-change-in-production
JWT_EXPIRATION_HOURS=24

# Request validation
MAX_REQUEST_SIZE_MB=10
MAX_JSON_DEPTH=10
ENABLE_SCHEMA_VALIDATION=true

# ================================================================
# ENVIRONMENT SPECIFIC SETTINGS
# ================================================================
# Environment identifier
ENVIRONMENT=production
DEPLOYMENT_STAGE=prod

# Resource limits
MAX_MEMORY_USAGE_MB=1024
MAX_CPU_PERCENTAGE=80

# Feature flags
ENABLE_EXPERIMENTAL_FEATURES=false
ENABLE_DEBUG_ENDPOINTS=false
ENABLE_ADMIN_ENDPOINTS=true

# ================================================================
# DOCKER AND DEPLOYMENT SETTINGS
# ================================================================
# Container metadata
BUILD_DATE=2024-07-25T00:00:00Z
VERSION=v2.0.0
BUILD_ARCH=amd64

# Network configuration
NETWORK_NAME=wazuh-mcp-network
SUBNET=172.20.0.0/16
GATEWAY=172.20.0.1

# Volume configuration
LOGS_DIR=./logs
CONFIG_DIR=./config
DATA_DIR=./data

# Domain and DNS
DOMAIN=wazuh-mcp.your-domain.com
DNS_SEARCH_DOMAIN=your-domain.com

# ================================================================
# BACKUP AND DISASTER RECOVERY
# ================================================================
# Backup configuration
ENABLE_AUTO_BACKUP=true
BACKUP_INTERVAL_HOURS=24
BACKUP_RETENTION_DAYS=30
BACKUP_DIRECTORY=/app/backups

# Health check endpoints
HEALTH_CHECK_PATH=/health
METRICS_PATH=/metrics
STATUS_PATH=/status

# ================================================================
# COMPLIANCE AND AUDITING
# ================================================================
# Compliance frameworks to check
ENABLE_PCI_DSS_CHECKS=true
ENABLE_HIPAA_CHECKS=true
ENABLE_SOX_CHECKS=true
ENABLE_GDPR_CHECKS=true
ENABLE_NIST_CHECKS=true

# Audit settings
AUDIT_LOG_RETENTION_DAYS=365
ENABLE_DETAILED_AUDITING=true
AUDIT_FAILED_REQUESTS=true
AUDIT_SENSITIVE_OPERATIONS=true

# ================================================================
# HIGH AVAILABILITY AND CLUSTERING (Future)
# ================================================================
# Clustering configuration (reserved for future use)
ENABLE_CLUSTERING=false
CLUSTER_NODE_ID=node-1
CLUSTER_DISCOVERY_METHOD=static
CLUSTER_PEERS=

# Load balancing
ENABLE_LOAD_BALANCING=false
LOAD_BALANCER_ALGORITHM=round_robin

# ================================================================
# ADVANCED CONFIGURATION
# ================================================================
# Timezone configuration
TZ=UTC

# Python optimization
PYTHONUNBUFFERED=1
PYTHONDONTWRITEBYTECODE=1
PYTHONHASHSEED=random

# FastMCP specific settings
FASTMCP_LOG_LEVEL=INFO
FASTMCP_ENABLE_VALIDATION=true
FASTMCP_MAX_CONCURRENT_REQUESTS=10

# HTTP client settings
HTTP_CLIENT_TIMEOUT=30
HTTP_CLIENT_MAX_REDIRECTS=5
HTTP_CLIENT_VERIFY_SSL=true
HTTP_CLIENT_USER_AGENT=WazuhMCPServer/2.0.0

# ================================================================
# END OF CONFIGURATION
# ================================================================
# Remember to:
# 1. Replace all placeholder values with your actual configuration
# 2. Secure sensitive values (passwords, API keys)
# 3. Test configuration with validate-production.py
# 4. Review security settings for your environment
# 5. Enable monitoring and logging appropriate for your needs