# Wazuh MCP Server Configuration
# Production-ready MCP-compliant server for Wazuh SIEM integration
# Copy to .env and update with your settings

# === Wazuh Configuration ===
WAZUH_HOST=https://your-wazuh-server.com
WAZUH_USER=your-api-user
WAZUH_PASS=your-api-password
WAZUH_PORT=55000

# === MCP Server Configuration ===
# Host to bind to (use 127.0.0.1 for local only, 0.0.0.0 for all interfaces)
MCP_HOST=127.0.0.1
MCP_PORT=3000

# === Authentication ===
# Secret key for token signing (generate with: openssl rand -hex 32)
AUTH_SECRET_KEY=your-secret-key-here

# Token lifetime in hours
TOKEN_LIFETIME_HOURS=24

# API keys (JSON array format)
# Example: [{"id":"key1","name":"Production","key_hash":"hash","scopes":["wazuh:read"]}]
API_KEYS=[
  {
    "id": "default",
    "name": "Default API Key",
    "key_hash": "will-be-generated",
    "created_at": "2024-01-01T00:00:00Z",
    "scopes": ["wazuh:read", "wazuh:write"],
    "active": true
  }
]

# === CORS Configuration ===
# Comma-separated list of allowed origins
ALLOWED_ORIGINS=https://claude.ai,https://*.anthropic.com,http://localhost:*

# === SSL Configuration (Optional) ===
# For HTTPS support
# SSL_KEYFILE=/path/to/privkey.pem
# SSL_CERTFILE=/path/to/fullchain.pem

# === Logging ===
LOG_LEVEL=INFO

# === Wazuh SSL ===
WAZUH_VERIFY_SSL=false
WAZUH_ALLOW_SELF_SIGNED=true

# === Wazuh Indexer Configuration (Required for Wazuh 4.8.0+) ===
# The vulnerability API was removed in Wazuh 4.8.0 and replaced with Indexer queries.
# Configure these settings to enable vulnerability tools.
# WAZUH_INDEXER_HOST=your-wazuh-indexer.com
# WAZUH_INDEXER_PORT=9200
# WAZUH_INDEXER_USER=admin
# WAZUH_INDEXER_PASS=admin

# === Session Storage (Serverless Ready) ===
# Optional Redis URL for serverless/multi-instance deployments
# If not set, uses in-memory storage (single-instance only)
# REDIS_URL=redis://localhost:6379/0
# SESSION_TTL_SECONDS=1800